<input type="file" id="fileInput" />
<button onclick="uploadFile()">Upload</button>

<script>
async function uploadFile() {
  const file = document.getElementById("fileInput").files[0];
  if (!file) {
    alert("Please select a file");
    return;
  }

  // Step 1: call backend to get presigned URL
  const res = await fetch("https://87pwi4umfk.execute-api.ap-southeast-1.amazonaws.com/upload-url", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ key: file.name, contentType: file.type, event: "manual" })
  });

  const data = await res.json();
  console.log("Presigned URL:", data.uploadUrl);

  // Step 2: upload file to S3
  const uploadRes = await fetch(data.uploadUrl, {
    method: "PUT",
    headers: { "Content-Type": file.type },
    body: file
  });

  if (uploadRes.ok) {
    alert("Upload success ✅");
  } else {
    alert("Upload failed ❌");
  }
}
</script>
